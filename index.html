<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>Csal√°di Napt√°r √©s Bev√°s√°rl√≥lista</title>
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" sizes="192x192" href="icon-192.png">
  <meta name="theme-color" content="#247BFF">
  <link rel="stylesheet" href="style.css">
  <script src="https://www.gstatic.com/firebasejs/9.21.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.21.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.21.0/firebase-firestore-compat.js"></script>
</head>
<body>
<div id="login-section">
  <h2>PIN k√≥dos bel√©p√©s</h2>
  <form id="pin-form" style="display:flex; flex-direction:column; gap:1rem;">
    <input type="tel" id="pin-input" inputmode="numeric" pattern="[0-9]*" maxlength="8" placeholder="PIN (2025)">
    <button id="pin-submit" type="button">Bel√©p√©s</button>
  </form>
  <div class="error" id="pin-error"></div>
</div>
<div id="main-section" style="display:none;">
  <header>
    <h1>üóìÔ∏è Csal√°di Napt√°r | üõí Bev√°s√°rl√≥lista</h1>
    <button id="logout-btn">Kijelentkez√©s</button>
  </header>
  <!-- N√©vnap ki√≠r√°s a napt√°r el≈ëtt -->
  <div id="nevnap-notice" style="text-align:center; font-size:1.1em; font-weight:bold; color:#247BFF; margin-bottom:0.7em;"></div>
  <section class="calendar-card">
    <div class="calendar-header">
      <button id="prev-month" class="calendar-arrow">&#8592;</button>
      <span id="calendar-title"></span>
      <button id="next-month" class="calendar-arrow">&#8594;</button>
    </div>
    <div class="calendar-days">
      <span>H</span><span>K</span><span>Sz</span><span>Cs</span><span>P</span><span>Szo</span><span>V</span>
    </div>
    <div id="calendar-grid" class="calendar-grid"></div>
  </section>
  <section id="calendar">
    <h2>Esem√©ny hozz√°ad√°s</h2>
    <form id="event-form">
      <input type="text" id="event-title" placeholder="Esem√©ny neve" required>
      <input type="time" id="event-from-time" required>
      <input type="time" id="event-to-time" required>
      <button type="submit">Hozz√°ad√°s</button>
    </form>
    <ul id="event-list"></ul>
  </section>
  <section id="shopping">
    <h2>Bev√°s√°rl√≥lista</h2>
    <form id="item-form">
      <input type="text" id="item-title" placeholder="T√©tel neve" required>
      <button type="submit">Hozz√°ad√°s</button>
    </form>
    <ul id="item-list"></ul>
  </section>
</div>
<script>
// --- N√âVNAPOK --- (teljes √©vre!)
const nevnapok = {
"1-1":["Fruzsina","√öj√©v"],"1-2":["√Åbel"],"1-3":["Genov√©va","Benj√°min"],"1-4":["Titusz","Leona"],"1-5":["Simon"],"1-6":["Boldizs√°r"],"1-7":["Attila","Ram√≥na"],"1-8":["Gy√∂ngyv√©r"],"1-9":["Marcell"],"1-10":["Mel√°nia"],"1-11":["√Ågota"],"1-12":["Ern≈ë"],"1-13":["Veronika"],"1-14":["B√≥dog"],"1-15":["L√≥r√°nt","Lor√°nd"],"1-16":["Guszt√°v"],"1-17":["Antal"],"1-18":["Piroska"],"1-19":["S√°ra","M√°ri√≥"],"1-20":["F√°bi√°n","Sebesty√©n"],"1-21":["√Ågnes"],"1-22":["Vince"],"1-23":["Emerencia"],"1-24":["Tim√≥t"],"1-25":["P√°l"],"1-26":["Vanda","Paula"],"1-27":["Angelika"],"1-28":["K√°roly","Aquilina"],"1-29":["Ad√©l"],"1-30":["Martina","Gerda"],"1-31":["Marcella"],
"2-1":["Ign√°c"],"2-2":["Karolina","Aida"],"2-3":["Bal√°zs"],"2-4":["R√°hel","Csenge"],"2-5":["√Ågota"],"2-6":["Dorottya","D√≥ra"],"2-7":["T√≥dor","R√≥me√≥"],"2-8":["Aranka"],"2-9":["Abigail"],"2-10":["Elvira"],"2-11":["Bertold","Marietta"],"2-12":["L√≠dia","L√≠via"],"2-13":["Ella","Linda"],"2-14":["B√°lint","Valentin"],"2-15":["Kolos","Georgina"],"2-16":["Julianna","Lilla"],"2-17":["Don√°t"],"2-18":["Bernadett"],"2-19":["Zsuzsanna"],"2-20":["Alad√°r","√Ålmos"],"2-21":["Eleon√≥ra"],"2-22":["Gerzson"],"2-23":["Alfr√©d"],"2-24":["M√°ty√°s"],"2-25":["√âva","Lujza"],"2-26":["Edina"],"2-27":["√Åkos","B√°tor"],"2-28":["Elem√©r"],"2-29":["Sz√∂k≈ënap"],
"3-1":["Albin"],"3-2":["Lujza"],"3-3":["Korn√©lia"],"3-4":["K√°zm√©r"],"3-5":["Adorj√°n"],"3-6":["Leon√≥ra","Inez"],"3-7":["Tam√°s"],"3-8":["J√°nos","Zolt√°n"],"3-9":["Franciska","Fanni"],"3-10":["Ildik√≥"],"3-11":["Szil√°rd"],"3-12":["Gergely"],"3-13":["Kriszti√°n"],"3-14":["Matild"],"3-15":["Krist√≥f"],"3-16":["Henrietta"],"3-17":["Gertr√∫d","Patrik"],"3-18":["S√°ndor","Ede"],"3-19":["J√≥zsef","B√°nk"],"3-20":["Klaudia"],"3-21":["Benedek"],"3-22":["Be√°ta","Izolda"],"3-23":["Em≈ëke"],"3-24":["G√°bor","Karina"],"3-25":["Ir√©n","√çrisz"],"3-26":["Em√°nuel"],"3-27":["Hajnalka"],"3-28":["Gedeon","Johanna"],"3-29":["Auguszta"],"3-30":["Zal√°n"],"3-31":["√Årp√°d"],
"4-1":["Hug√≥"],"4-2":["√Åron"],"4-3":["Buda","Rich√°rd"],"4-4":["Izidor"],"4-5":["Vince"],"4-6":["Vilmos","B√≠borka"],"4-7":["Herman"],"4-8":["D√©nes"],"4-9":["Erhard"],"4-10":["Zsolt"],"4-11":["Le√≥"],"4-12":["Gyula"],"4-13":["Ida"],"4-14":["Tibor"],"4-15":["Anaszt√°zia"],"4-16":["Csongor"],"4-17":["Rudolf"],"4-18":["Andrea","Ilma"],"4-19":["Emma"],"4-20":["Tivadar"],"4-21":["Konr√°d"],"4-22":["Csilla","No√©mi"],"4-23":["B√©la"],"4-24":["Gy√∂rgy"],"4-25":["M√°rk"],"4-26":["Ervin"],"4-27":["Zita"],"4-28":["Val√©ria"],"4-29":["P√©ter"],"4-30":["Katalin","Kitti"],
"5-1":["F√ºl√∂p","Jakab"],"5-2":["Zsigmond"],"5-3":["T√≠mea"],"5-4":["M√≥nika","Fl√≥ri√°n"],"5-5":["Gy√∂rgyi"],"5-6":["Frida","Ivett"],"5-7":["Gizella"],"5-8":["Mih√°ly"],"5-9":["Gergely"],"5-10":["√Årmin"],"5-11":["Ferenc"],"5-12":["Pongr√°c"],"5-13":["Szerv√°c"],"5-14":["Bonif√°c"],"5-15":["Zs√≥fia"],"5-16":["M√≥zes","Botond"],"5-17":["Paszk√°l"],"5-18":["Erik","Alex"],"5-19":["Iv√≥","Mil√°n"],"5-20":["Bern√°t","F√©lix"],"5-21":["Konstantin"],"5-22":["J√∫lia","Rita"],"5-23":["Dezs≈ë"],"5-24":["Eszter","Eliza"],"5-25":["Orb√°n"],"5-26":["Evelin","F√ºl√∂p"],"5-27":["Hella"],"5-28":["Emil","Csan√°d"],"5-29":["Magdolna"],"5-30":["Janka","Zsanett"],"5-31":["Ang√©la","Petronella"],
"6-1":["T√ºnde"],"6-2":["K√°rmen","Anita"],"6-3":["Klotild"],"6-4":["Bulcs√∫"],"6-5":["Fatime"],"6-6":["Norbert"],"6-7":["R√≥bert"],"6-8":["Med√°rd"],"6-9":["F√©lix"],"6-10":["Margit"],"6-11":["Barnab√°s"],"6-12":["Vill≈ë"],"6-13":["Antal","Anett"],"6-14":["Vazul"],"6-15":["Jol√°n","Vid"],"6-16":["Jusztin"],"6-17":["Laura"],"6-18":["Arnold","Levente"],"6-19":["Gy√°rf√°s"],"6-20":["Rafael"],"6-21":["Alajos"],"6-22":["Paulina"],"6-23":["Zolt√°n"],"6-24":["Iv√°n"],"6-25":["Vilmos"],"6-26":["J√°nos","P√°l"],"6-27":["L√°szl√≥"],"6-28":["Levente","Ir√©n"],"6-29":["P√©ter","P√°l"],"6-30":["P√°l"],
"7-1":["Tiham√©r","Annam√°ria"],"7-2":["Ott√≥"],"7-3":["Korn√©l","Soml√≥"],"7-4":["Ulrik"],"7-5":["Emese","Sarolta"],"7-6":["Csaba"],"7-7":["Appol√≥nia"],"7-8":["Ell√°k"],"7-9":["Lukr√©cia"],"7-10":["Am√°lia"],"7-11":["N√≥ra","Lili"],"7-12":["Izabella","Dalma"],"7-13":["Jen≈ë"],"7-14":["√ñrs","Stella"],"7-15":["Henrik","Roland"],"7-16":["Valter"],"7-17":["Endre","Eleon√≥ra"],"7-18":["Frigyes"],"7-19":["Em√≠lia"],"7-20":["Ill√©s"],"7-21":["D√°niel","Danina"],"7-22":["Magdolna"],"7-23":["Lenke"],"7-24":["Kinga","Kincs≈ë"],"7-25":["Krist√≥f"],"7-26":["Anna","Anik√≥"],"7-27":["Olga","Lili√°na"],"7-28":["Szabolcs"],"7-29":["M√°rta"],"7-30":["Judit"],"7-31":["Oszk√°r"],
"8-1":["Bogl√°rka"],"8-2":["Lehel"],"8-3":["Hermina"],"8-4":["Dominika","Domonkos"],"8-5":["Krisztina"],"8-6":["Berta","Szid√≥nia"],"8-7":["Ibolya"],"8-8":["L√°szl√≥"],"8-9":["Em≈ëd"],"8-10":["L≈ërinc"],"8-11":["Zsuzsanna","Tiborc"],"8-12":["Kl√°ra"],"8-13":["Ipoly"],"8-14":["Marcell"],"8-15":["M√°ria"],"8-16":["√Åbrah√°m"],"8-17":["J√°cint"],"8-18":["Ilona"],"8-19":["Huba"],"8-20":["Istv√°n"],"8-21":["S√°muel","Hajna"],"8-22":["Menyh√©rt","Mirjam"],"8-23":["Bence"],"8-24":["Bertalan"],"8-25":["Lajos","Patr√≠cia"],"8-26":["Izs√≥"],"8-27":["G√°sp√°r","√Ågoston"],"8-28":["√Ågnes"],"8-29":["Beatrix","Erna"],"8-30":["R√≥zsa"],"8-31":["Erika","Bella"],
"9-1":["Egyed"],"9-2":["Dorina","Rebeka"],"9-3":["Hilda"],"9-4":["Roz√°lia"],"9-5":["Viktor","L≈ërinc"],"9-6":["Zakari√°s"],"9-7":["Regina"],"9-8":["M√°ria"],"9-9":["√Åd√°m"],"9-10":["Nikolett"],"9-11":["Teod√≥ra"],"9-12":["M√°ria"],"9-13":["Korn√©l"],"9-14":["Szer√©na","R√≥me√≥"],"9-15":["Enik≈ë","Melitta"],"9-16":["Edit"],"9-17":["Zs√≥fia"],"9-18":["Di√°na"],"9-19":["Vilhelmina"],"9-20":["Friderika"],"9-21":["M√°t√©","Mirella"],"9-22":["M√≥ric"],"9-23":["Tekla"],"9-24":["Gell√©rt","Merc√©desz"],"9-25":["Eufrozina","Kende"],"9-26":["Jusztina"],"9-27":["Adalbert"],"9-28":["Vencel"],"9-29":["Mih√°ly"],"9-30":["Jeromos"],
"10-1":["Malvin"],"10-2":["Petra"],"10-3":["Helga"],"10-4":["Ferenc"],"10-5":["Aur√©l"],"10-6":["Br√∫n√≥"],"10-7":["Am√°lia"],"10-8":["Kopp√°ny"],"10-9":["D√©nes"],"10-10":["Gedeon"],"10-11":["Brigitta"],"10-12":["Miksa"],"10-13":["K√°lm√°n","Ede"],"10-14":["Hel√©n"],"10-15":["Ter√©z"],"10-16":["G√°l"],"10-17":["Hedvig"],"10-18":["Luk√°cs"],"10-19":["N√°ndor"],"10-20":["Vendel"],"10-21":["Orsolya"],"10-22":["El≈ëd"],"10-23":["Gy√∂ngyi"],"10-24":["Salamon"],"10-25":["Bianka","Blanka"],"10-26":["D√∂m√∂t√∂r"],"10-27":["Szabina"],"10-28":["Simon","J√∫d√°s"],"10-29":["N√°rcisz"],"10-30":["Alfonz"],"10-31":["Farkas"],
"11-1":["Marianna"],"11-2":["Achilles","Csilla"],"11-3":["Gy≈ëz≈ë"],"11-4":["K√°roly"],"11-5":["Imre"],"11-6":["L√©da"],"11-7":["Rezs≈ë"],"11-8":["Zsolt"],"11-9":["Tivadar"],"11-10":["R√©ka","G√°sp√°r"],"11-11":["M√°rton"],"11-12":["J√≥n√°s","Ren√°t√≥"],"11-13":["Szilvia"],"11-14":["J√≥zsef"],"11-15":["Aliz"],"11-16":["√ñd√∂n"],"11-17":["Hortenzia"],"11-18":["Jen≈ë"],"11-19":["Erzs√©bet"],"11-20":["Zolt√°n"],"11-21":["Oliv√©r"],"11-22":["Cec√≠lia"],"11-23":["Kelemen","Korn√©l"],"11-24":["Emma"],"11-25":["Katalin"],"11-26":["Vir√°g"],"11-27":["Virgil"],"11-28":["Stef√°nia"],"11-29":["Taksony"],"11-30":["Andr√°s","Andor"],
"12-1":["Elza"],"12-2":["Melinda","Vivien"],"12-3":["Ferenc"],"12-4":["Borb√°la"],"12-5":["Vilma"],"12-6":["Mikl√≥s"],"12-7":["Ambrus"],"12-8":["M√°ria"],"12-9":["Nat√°lia"],"12-10":["Judit"],"12-11":["√Årp√°d"],"12-12":["Gabriella"],"12-13":["Luca"],"12-14":["Szil√°rda"],"12-15":["Val√©r"],"12-16":["Etelka","Aletta"],"12-17":["L√°z√°r"],"12-18":["Auguszta"],"12-19":["Viola"],"12-20":["Teofil"],"12-21":["Tam√°s"],"12-22":["Z√©n√≥"],"12-23":["Vikt√≥ria"],"12-24":["√Åd√°m","√âva"],"12-25":["Eugen","Anaszt√°zia"],"12-26":["Istv√°n"],"12-27":["J√°nos"],"12-28":["Kamilla"],"12-29":["Tam√°s"],"12-30":["D√°vid"],"12-31":["Szilveszter"]
};

function nevnapKiiras() {
  const today = new Date();
  const key = (today.getMonth()+1) + "-" + today.getDate();
  const nev = typeof nevnapok !== "undefined" ? nevnapok[key] : [];
  document.getElementById("nevnap-notice").textContent =
    nev && nev.length ? `Ma ${nev.join(", ")} n√©vnapja van!` : "";
}
nevnapKiiras();


// --- A t√∂bbi eredeti JS funkci√≥ v√°ltozatlanul marad ---
const firebaseConfig = {
  // ... ide j√∂n a saj√°t Firebase configod ...
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();
db.enablePersistence().catch(function(err) {
  console.log("Offline t√°mogat√°s hib√°ja:", err.code);
});
const CORRECT_PIN = "2025";
const loginSection = document.getElementById("login-section");
const mainSection = document.getElementById("main-section");
const pinInput = document.getElementById("pin-input");
const pinBtn = document.getElementById("pin-submit");
const pinError = document.getElementById("pin-error");
pinBtn.onclick = function() {
  if (pinInput.value === CORRECT_PIN) {
    loginSection.style.display = "none";
    mainSection.style.display = "block";
    anonymousSignIn();
  } else {
    pinError.innerText = "Hib√°s PIN!";
  }
};
pinInput.addEventListener("keyup", function(event) {
  if (event.key === "Enter") pinBtn.click();
});
document.getElementById("logout-btn").onclick = function() {
  mainSection.style.display = "none";
  loginSection.style.display = "block";
  pinInput.value = "";
  firebase.auth().signOut();
};
function askPinForDelete(cb) {
  let pin = prompt("T√∂rl√©shez add meg a PIN-t:");
  if (pin === CORRECT_PIN) cb();
  else alert("Hib√°s PIN!");
}
function anonymousSignIn() {
  auth.signInAnonymously().then(() => {
    fetchMonthlyEventsAndRender();
    loadEvents();
    loadItems();
  }).catch(error => {
    pinError.innerText = "Firebase auth hiba: " + error.message;
  });
}
const calendarGrid = document.getElementById("calendar-grid");
const calendarTitle = document.getElementById("calendar-title");
const prevMonthBtn = document.getElementById("prev-month");
const nextMonthBtn = document.getElementById("next-month");
let currentMonth = new Date().getMonth();
let currentYear = new Date().getFullYear();
let selectedDay = new Date().toISOString().slice(0, 10);
function renderCalendar(evMap={}) {
  let d = new Date(currentYear, currentMonth);
  calendarTitle.textContent = d.toLocaleString('hu', { month: 'long' }) + " " + currentYear;
  const firstDay = new Date(currentYear, currentMonth, 1).getDay() || 7;
  const daysInMonth = new Date(currentYear, currentMonth+1, 0).getDate();
  calendarGrid.innerHTML = "";
  for(let i=1; i<firstDay; i++) { calendarGrid.innerHTML += `<div></div>`; }
  for(let day=1; day<=daysInMonth; day++) {
    const cellDate = `${currentYear}-${String(currentMonth+1).padStart(2,'0')}-${String(day).padStart(2,'0')}`;
    const today = new Date();
    let extra = "";
    if (cellDate === today.toISOString().slice(0, 10)) extra += " today";
    let selected = "";
    if (cellDate === selectedDay) selected += " selected";
    let eventi = evMap[cellDate];
    let dotsHTML = "";
    let countHTML = "";
    if (eventi && eventi.length > 0) {
      const dotCount = Math.min(eventi.length, 3);
      for(let i=0;i<dotCount;i++) {
        dotsHTML += `<div class="calendar-dot" style="left:${28 + 18*i}%"></div>`;
      }
      if (eventi.length > 3) {
        countHTML = `<span class="calendar-count">(${eventi.length})</span>`;
      }
    }
    calendarGrid.innerHTML += `
      <div class="calendar-cell${extra}${selected}" data-date="${cellDate}" style="position:relative;">
        ${day}
        ${dotsHTML}
        ${countHTML}
      </div>
    `;
  }
  document.querySelectorAll('.calendar-cell').forEach(cell => {
    cell.onclick = () => {
      selectedDay = cell.getAttribute('data-date');
      document.querySelectorAll('.calendar-cell').forEach(c => c.classList.remove('selected'));
      cell.classList.add('selected');
      loadEvents();
    };
  });
}
prevMonthBtn.onclick = () => {
  currentMonth--;
  if(currentMonth<0) { currentMonth=11; currentYear--; }
  fetchMonthlyEventsAndRender();
};
nextMonthBtn.onclick = () => {
  currentMonth++;
  if(currentMonth>11) { currentMonth=0; currentYear++; }
  fetchMonthlyEventsAndRender();
};
function fetchMonthlyEventsAndRender() {
  const start = `${currentYear}-${String(currentMonth+1).padStart(2,'0')}-01T00:00`;
  const end = `${currentYear}-${String(currentMonth+1).padStart(2,'0')}-${String(new Date(currentYear, currentMonth+1, 0).getDate()).padStart(2,'0')}T23:59`;
  db.collection("events")
    .where("from", ">=", start)
    .where("from", "<=", end)
    .get()
    .then(snapshot=>{
       let evMap = {};
       snapshot.forEach(doc=>{
         let d = (doc.data().from || "").slice(0,10);
         if(d) {
           if(!evMap[d]) evMap[d] = [];
           evMap[d].push(doc.data());
         }
       });
       renderCalendar(evMap);
    });
}
auth.onAuthStateChanged(user=>{
  if(user) { fetchMonthlyEventsAndRender(); }
});
const eventForm = document.getElementById("event-form");
const eventList = document.getElementById("event-list");
eventForm.onsubmit = function(e) {
  e.preventDefault();
  const title = document.getElementById("event-title").value;
  const fromTime = document.getElementById("event-from-time").value;
  const toTime = document.getElementById("event-to-time").value;
  if (!title || !fromTime || !toTime) return;
  db.collection("events").add({
    title,
    from: selectedDay + "T" + fromTime,
    to: selectedDay + "T" + toTime,
    done: false
  }).then(()=>{
    fetchMonthlyEventsAndRender();
    loadEvents();
  });
  eventForm.reset();
};
function loadEvents() {
  db.collection("events")
    .where("from", ">=", selectedDay + "T00:00")
    .where("from", "<=", selectedDay + "T23:59")
    .orderBy("from")
    .onSnapshot(snap => {
      eventList.innerHTML = "";
      snap.forEach(doc => {
        const { title, from, to, done } = doc.data();
        const li = document.createElement("li");
        if (done) li.classList.add("done");
        li.innerHTML = `
          <label>
            <input type="checkbox" ${done ? "checked" : ""}>
            ${title} (${from.slice(11,16)} ‚Äì ${to.slice(11,16)})
          </label>
          <button class="delete-btn" title="T√∂rl√©s">üóëÔ∏è</button>
        `;
        li.querySelector("input").onchange = () => {
          doc.ref.update({ done: !done });
          fetchMonthlyEventsAndRender();
        };
        li.querySelector(".delete-btn").onclick = () =>
          askPinForDelete(() => { doc.ref.delete(); fetchMonthlyEventsAndRender(); });
        eventList.appendChild(li);
      });
  });
}
const itemForm = document.getElementById("item-form");
const itemList = document.getElementById("item-list");
itemForm.onsubmit = function(e) {
  e.preventDefault();
  const title = document.getElementById("item-title").value;
  if (!title) return;
  db.collection("items").add({ title, done: false });
  itemForm.reset();
};
function loadItems() {
  db.collection("items").onSnapshot(snap => {
    itemList.innerHTML = "";
    snap.forEach(doc => {
      const { title, done } = doc.data();
      const li = document.createElement("li");
      if (done) li.classList.add("done");
      li.innerHTML = `
        <label>
          <input type="checkbox" ${done ? "checked" : ""}>
          ${title}
        </label>
        <button class="delete-btn" title="T√∂rl√©s">üóëÔ∏è</button>
      `;
      li.querySelector("input").onchange = () => {
        doc.ref.update({ done: !done });
      };
      li.querySelector(".delete-btn").onclick = () =>
        askPinForDelete(() => doc.ref.delete());
      itemList.appendChild(li);
    });
  });
}
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("sw.js")
    .then(reg => console.log("SW regisztr√°lva!", reg.scope))
    .catch(err => console.log("SW hiba:", err));
}
</script>
</body>
</html>
