<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>FamilyBoard ‚Äì Blog √ºzen≈ëfal</title>
  <link rel="manifest" href="../manifest.webmanifest">
  <link rel="stylesheet" href="../style.css">
  <link rel="stylesheet" href="./blog.css">
  <script>
    (function(){try{var ok=sessionStorage.getItem('FB_PIN_OK')==='1'; if(!ok) document.documentElement.classList.add('pin-required');}catch(e){document.documentElement.classList.add('pin-required');}})();
  </script>
  <style>
    html.pin-required #content{display:none}
    html.pin-required #pinMsg{display:flex}
    #pinMsg{display:none;min-height:50vh;align-items:center;justify-content:center;text-align:center;padding:2rem}
    #pinMsg .card{border:1px solid var(--border,#e5e7eb);background:#fff;border-radius:12px;padding:1.2rem;max-width:520px;box-shadow:0 8px 28px rgba(0,0,0,.08)}
  </style>
  <script src="https://www.gstatic.com/firebasejs/9.21.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.21.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.21.0/firebase-firestore-compat.js"></script>
  <script>
    const firebaseConfig={apiKey:"AIzaSyAeoxtOe5Cleasm3KdeSHP9WDR3PkU-N1I",authDomain:"mosas-nyilvantartas.firebaseapp.com",projectId:"mosas-nyilvantartas",messagingSenderId:"38259241645",appId:"1:38259241645:web:26070b1d0686def9f00c24"};
    if(!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const auth=firebase.auth(); const db=firebase.firestore();
    db.enablePersistence().catch(err=>console.log("Blog offline perzisztencia:",err?.code||err));
    auth.onAuthStateChanged(u=>{ if(!u) auth.signInAnonymously().catch(console.log); });
  </script>
</head>
<body>
  <div id="pinMsg">
    <div class="card">
      <h2 style="margin:.2rem 0 .6rem">Nincs enged√©ly</h2>
      <p style="color:#555;margin:.2rem 0 1rem">A blog megtekint√©s√©hez add meg a PIN k√≥dot a f≈ëoldalon.</p>
      <a href="../index.html" class="weather-link" style="background:#247BFF;color:#fff;padding:.6rem 1rem;border-radius:8px;text-decoration:none;">‚Üê Vissza a f≈ëoldalra</a>
    </div>
  </div>
  <div id="content">
    <header class="fb-header">
      <div class="fb-container">
        <h1 class="fb-title">Blog t√≠pus√∫ √ºzen≈ëfal</h1>
        <nav class="fb-nav"><a class="fb-link" href="../index.html">‚Üê Vissza a f≈ëoldalra</a></nav>
      </div>
    </header>
    <main class="fb-container fb-main">
      <section class="fb-toolbar">
        <input id="searchInput" type="search" placeholder="Keres√©s a bejegyz√©sekben‚Ä¶" aria-label="Keres√©s">
        <select id="sortSelect" aria-label="Rendez√©s">
          <option value="newest">Leg√∫jabb el√∂l</option>
          <option value="oldest">Legr√©gebbi el√∂l</option>
          <option value="title">C√≠m szerint (A‚ÜíZ)</option>
        </select>
        <button id="newPostBtn" class="fb-btn primary">√öj bejegyz√©s</button>
      </section>
      <section id="tagChips" class="fb-chips" aria-label="C√≠mk√©k sz≈±r√©se"></section>
      <section id="postGrid" class="fb-grid" aria-live="polite"></section>
    </main>
    <dialog id="postModal">
      <form method="dialog" id="postForm" class="fb-modal">
        <header class="fb-modal-header">
          <h2 id="modalTitle">√öj bejegyz√©s</h2>
          <button type="button" id="closeModal" class="fb-icon-btn" aria-label="Bez√°r√°s">‚úï</button>
        </header>
        <div class="fb-modal-body">
          <label class="fb-field"><span>C√≠m</span><input type="text" id="titleInput" required maxlength="140" placeholder="Bejegyz√©s c√≠me"></label>
          <label class="fb-field"><span>Tartalom (Markdown t√°mogatott)</span><textarea id="contentInput" rows="8" placeholder="√çrd ide a bejegyz√©st‚Ä¶"></textarea></label>
          <div class="fb-two-cols">
            <label class="fb-field"><span>C√≠mk√©k (vessz≈ëvel elv√°lasztva)</span><input type="text" id="tagsInput" placeholder="pl. recept, program"></label>
            <label class="fb-field checkbox"><input type="checkbox" id="pinnedInput"><span>R√∂gz√≠tett (fel√ºl jelenik meg)</span></label>
          </div>
          <label class="fb-field"><span>K√©p (opcion√°lis)</span><input type="file" id="imageInput" accept="image/*"></label>
          <details class="fb-preview"><summary>El≈ën√©zet</summary><article id="preview" class="fb-card fb-post"></article></details>
        </div>
        <footer class="fb-modal-footer">
          <button type="submit" class="fb-btn primary" id="saveBtn">Ment√©s</button>
          <button type="button" class="fb-btn" id="deleteBtn">T√∂rl√©s</button>
        </footer>
      </form>
    </dialog>
    <template id="postCardTmpl">
      <article class="fb-card fb-post">
        <img class="fb-post-img" alt="" hidden>
        <div class="fb-post-body">
          <header class="fb-post-header">
            <h3 class="fb-post-title"></h3>
            <div class="fb-post-meta">
              <time class="fb-post-date"></time>
              <span class="fb-pin" hidden>üìå r√∂gz√≠tett</span>
            </div>
          </header>
          <div class="fb-post-content"></div>
          <footer class="fb-post-footer">
            <div class="fb-tags"></div>
            <div class="fb-actions">
              <button class="fb-icon-btn edit" title="Szerkeszt√©s" aria-label="Szerkeszt√©s">‚úèÔ∏è</button>
              <button class="fb-icon-btn del" title="T√∂rl√©s" aria-label="T√∂rl√©s">üóëÔ∏è</button>
            </div>
          </footer>
        </div>
      </article>
    </template>
    <script src="./blog.js" type="module"></script>
  </div>
</body>
</html>
